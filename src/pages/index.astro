---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import LastFMPlayer from '../components/islands/LastFMPlayer';
import StrangeAttractor from '../components/islands/StrangeAttractor';

const writing = await getCollection('writing', ({ data }) =>
  (data.type === 'post' || data.type === 'bit') && data.published
);
const recentWriting = writing
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 3);
---

<BaseLayout isHome={true}>
  <div class="max-w-2xl px-6 py-16">
    <!-- Hero -->
    <section class="mb-12">
      <h1 class="text-5xl md:text-6xl font-bold tracking-tight">
        Simon Bukin
      </h1>
      <p class="mt-4 text-lg text-neutral-400">
        Design engineer building quality user experiences.
      </p>
      <p class="mt-2 text-neutral-400">
        Currently automating healthcare at{' '}
        <a
          href="https://morf.health"
          target="_blank"
          rel="noopener noreferrer"
          class="inline-flex items-center gap-1.5 text-[#4f46ff] hover:text-[#6b6bff] transition-colors"
        >
          <img src="/morf-logo.png" alt="" class="w-4 h-4" />
          Morf
        </a>
      </p>
    </section>

    <!-- Navigation -->
    <nav class="mb-12">
      <ul class="space-y-3">
        <li>
          <a href="/writing" class="group flex items-baseline gap-3">
            <span class="font-medium group-hover:text-white transition-colors">Writing</span>
            <span class="text-sm text-neutral-400">Thoughts and tutorials</span>
          </a>
        </li>
        <li>
          <a href="/portfolio" class="group flex items-baseline gap-3">
            <span class="font-medium group-hover:text-white transition-colors">Work</span>
            <span class="text-sm text-neutral-400">Case studies and portfolio</span>
          </a>
        </li>
        <li>
          <a href="/media" class="group flex items-baseline gap-3">
            <span class="font-medium group-hover:text-white transition-colors">Media</span>
            <span class="text-sm text-neutral-400">Movies, shows, games, music</span>
          </a>
        </li>
        <li>
          <a href="/about" class="group flex items-baseline gap-3">
            <span class="font-medium group-hover:text-white transition-colors">About</span>
            <span class="text-sm text-neutral-400">Background and interests</span>
          </a>
        </li>
        <li>
          <a href="/contact" class="group flex items-baseline gap-3">
            <span class="font-medium group-hover:text-white transition-colors">Contact</span>
            <span class="text-sm text-neutral-400">Get in touch</span>
          </a>
        </li>
      </ul>
    </nav>

    <!-- Recent Writing -->
    {recentWriting.length > 0 && (
      <section class="mb-12">
        <div class="flex items-baseline gap-4 mb-4">
          <h2 class="text-lg font-semibold">Recent</h2>
          <a href="/writing" class="text-sm text-neutral-400 hover:text-white transition-colors">
            All &rarr;
          </a>
        </div>
        <ul class="space-y-3">
          {recentWriting.map((item) => (
            <li>
              <a href={`/writing/${item.slug}`} class="group block">
                <span class="font-medium group-hover:text-white transition-colors">{item.data.title}</span>
                <span class="text-sm text-neutral-400 ml-2">
                  {item.data.date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })}
                </span>
              </a>
            </li>
          ))}
        </ul>
      </section>
    )}

    <!-- Now Playing -->
    <section>
      <LastFMPlayer client:load />
    </section>

    <!-- Small screen attractor -->
    <div class="lg:hidden">
      <StrangeAttractor client:load variant="contained" />
    </div>
  </div>
</BaseLayout>
